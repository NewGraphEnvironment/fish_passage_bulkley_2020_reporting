---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup-197542, eval = F}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
source('R/packages.R')
source('R/functions.R')
source('R/functions-phase2.R')
source('R/tables-phase2.R')
source('R/tables.R')
source('R/extract-fish.R')
source('R/functions-fish.R')


```



```{r  load-data-197542}
my_site <- 197542

```


```{r eval = F}
my_bcfish <- my_bcfishpass() ##can be useful to look at

# `r paste0('# Appendix - Crossing ', my_site)`{-} 
# `r paste0('**', my_overview_info() %>% pull(road_name), ' - ', my_overview_info() %>% pull(stream_name), '**')`
```

`r appendix_title()`
`r appendix_subtitle()`



## Site Location {-}

Crossing `r as.character(my_site)` is located on a `r my_pscis_info() %>% pull(stream_name)`, approximately `r my_priority_info(loc = 'ds') %>% pull(survey_length_m)`m upstream from the confluence with the Elk River. The crossing is located on `r my_overview_info() %>% pull(road_name)` just north of Fernie.  `r my_overview_info() %>% pull(road_name)` is a paved local road accessing residences and recreational areas.   


<br>

## Background {-}

At the crossing location, the stream is `r my_bcfishpass() %>% pull(stream_order) %>% english::ordinal()` order with a watershed area upstream of the road of approximately `r my_bcfishpass() %>% mutate(watershed_upstr_ha = watershed_upstr_ha/100) %>% pull(watershed_upstr_ha) %>% round(1)` km^2^. The elevation of the watershed ranges from a maximum of 2350 to 1030m at the culvert. Although, there are several modelled crossings on the mainstem of Hartley Creek upstream of the crossing, 2020 surveys indicated they were either fords or bridges. Westslope cutthroat trout, bull trout and brook trout have been recorded upstream in Hartley Creek [@data_fish_obs].   

<br>

PSCIS stream crossing `r as.character(my_site)` was ranked as a high priority for follow up with habitat confirmation due to the large amount of potential habitat modelled upstream (13km). The habitat confirmation was completed on `r my_pscis_info() %>% pull(date) %>% format(., format = "%B %d, %Y")`. A map of the watershed including areas surveyed is provided in Attachment 1 â€“ Map [`r my_bcfishpass() %>% pull(map_tile_display_name)`](`r my_mapsheet()`).

<br>

## Stream Characteristics at Crossing {-}

At the time of the survey, the un-embedded and non-backwatered `r my_pscis_info() %>% pull(diameter_or_span_meters)`m diameter crossing was considered a barrier to upstream fish passage with a pipe length of `r my_pscis_info() %>% pull(length_or_width_meters)`m, a culvert slope of `r my_pscis_info() %>% pull(culvert_slope_percent)`%, a stream width ratio of `r my_pscis_info() %>% pull(stream_width_ratio)` and an outlet drop of `r my_pscis_info() %>% pull(outlet_drop_meters)`m (Table \@ref(tab:tab-culvert-197542)). Water temperature was `r my_habitat_info() %>% filter(rowname == 'temperature c') %>% pull(us)`$^\circ$C, pH was `r my_habitat_info() %>% filter(rowname == 'p h') %>% pull(us)` and conductivity was `r my_habitat_info() %>% filter(rowname == 'conductivity m s cm') %>% pull(us)`uS/cm.  

<br>


```{r eval=F}
##this is useful to get some comments for the report
hab_site %>% filter(site == my_site & location == 'ds') %>% pull(comments)
my_hab_info <- my_habitat_info()
```

## Stream Characteristics Downstream {-}

The stream was surveyed downstream from the culvert for `r my_priority_info(loc = 'ds') %>% pull(survey_length_m)`m to the confluence with the downstream channel. The mouth of the stream is located approximately 100m east of where it is mapped on the freshwater atlas stream layer. Overall, total cover amount was rated as `r my_habitat_info2(loc = 'ds') %>% filter(rowname == 'total cover') %>% pull(v)` with  `r my_habitat_info2(loc = 'ds') %>% filter(v == 'dominant') %>% pull(rowname)` dominant. Cover was also present as `r my_habitat_info2(loc = 'ds') %>% filter(v == 'sub-dominant') %>% pull(rowname) %>% knitr::combine_words()` (Table \@ref(tab:tab-habitat-summary-197542), Figure \@ref(fig:photo-197542-01)). The average channel width was `r my_habitat_info3(loc = 'ds', row = 'avg channel width m')`m, the average wetted width was `r my_habitat_info3(loc = 'ds', row = 'avg wetted width m')`m and the average gradient was `r my_habitat_info3(loc = 'ds', row = 'average gradient percent')`%.  The dominant substrate was `r my_habitat_info3(loc = 'ds', row = "bed material dominant")` with `r my_habitat_info3(loc = 'ds', row = "bed material subdominant")` subdominant.  Intermittent smaller pools and pockets of gravels suitably sized for resident salmonid spawning were present. Habitat was rated as `r my_priority_info(loc = 'ds') %>%  pull(hab_value)` value for fry/juvenile salmonid rearing.


```{r eval=F}
##this is useful to get some comments for the report
hab_site %>% filter(site == my_site & location == 'us') %>% pull(comments)
my_hab_info <- my_habitat_info()
```


<br>

## Stream Characteristics Upstream {-}

The stream was surveyed upstream from the culvert for `r my_priority_info(loc = 'us') %>% pull(survey_length_m)`m. Overall, total cover amount was rated as `r my_habitat_info2(loc = 'us') %>% filter(rowname == 'total cover') %>% pull(v)` with  `r my_habitat_info2(loc = 'us') %>% filter(v == 'dominant') %>% pull(rowname)` dominant. Cover was also present as `r my_habitat_info2(loc = 'us') %>% filter(v == 'sub-dominant') %>% pull(rowname) %>% knitr::combine_words()` (Table \@ref(tab:tab-habitat-summary-197542), Figure \@ref(fig:photo-197542-02)). The average channel width was `r my_habitat_info3(loc = 'us', row = 'avg channel width m')`m, the average wetted width was `r my_habitat_info3(loc = 'us', row = 'avg wetted width m')`m and the average gradient was `r my_habitat_info3(loc = 'us', row = 'average gradient percent')`%.  The dominant substrate was `r my_habitat_info3(loc = 'us', row = "bed material dominant")` with `r my_habitat_info3(loc = 'us', row = "bed material subdominant")` subdominant. Good flows were present and some pockets of gravels suitable for spawning were observed thorughout.  There were steps ranging from 0.5 - 0.8m due to large woody debris jams but no permanent migration barriers were observed until a cascade at the top end of the survey area (24% for >50m). Habitat was rated as `r my_priority_info(loc = 'us') %>% pull(hab_value)` value for fry and juvenile westslope cutthrout trout rearing. 

<br>


## Structure Remediation and Cost Estimate {-}

Structure replacement with an open bottomed structure is recommended to provide access to the habitat located upstream of PSCIS crossing `r as.character(my_site)`.  The cost of the work is estimated at \$`r as.character(my_cost_estimate() %>% pull(cost_est_1000s) * 1000)` for a cost benefit of \$`r as.character(my_cost_estimate() %>% pull(cost_net) * 1000)`/linear m and \$`r as.character(my_cost_estimate() %>% pull(cost_area_net) * 1000)`/m^2^.

<br>

## Conclusion {-}

There is an estimated `r my_priority_info() %>% pull(upstream_habitat_length_km)`km of mainstem habitat upstream of crossing `r as.character(my_site)` with habitat in the areas surveyed upstream of the crossing rated as `r my_priority_info(loc = 'us') %>% pull(hab_value)` value for fry and juvenile salmonid rearing. Density of westslope cutthrout trout parr was higher in the site sampled downstream of the crossing when compared to the upstream site with fry, juvenile and adult fish captured downstren only. The `r my_overview_info() %>% pull(road_name)` is under tenure of the Ministry of Forests, Lands, Natural Resource Operations & Rural Development. The crossing was ranked as a `r my_priority_info() %>% pull(priority)` priority for proceeding to design for replacement with an open bottomed structure and consideration of remediation of PSCIS 50185 ([Appendix - Crossing 50185]) should be considered at the same time for maximum potential benefits.

\pagebreak

```{r tab-culvert-197542, eval = T}
print_tab_summary()

```

\pagebreak

```{r tab-habitat-summary-197542}
tab_hab_summary %>% 
  filter(Site  == my_site) %>% 
  select(-Site) %>% 
  my_kable(caption_text = paste0('Summary of habitat details for PSCIS crossing ', my_site, '.'))

```



<br>

```{r photo-197542-01, fig.cap= my_caption, out.width = photo_width, eval=T}
my_photo = pull_photo_by_str(str_to_pull = '_d1_')

my_caption = paste0('Typical habitat downstream of PSCIS crossing ', my_site, '.')

grid::grid.raster(get_img())

# knitr::include_graphics(get_img_path())
```

<br>

```{r photo-197542-01b, fig.cap= my_caption, out.width = photo_width, eval=T}
my_photo = pull_photo_by_str(str_to_pull = '_d2_')

my_caption = paste0('Typical habitat downstream of PSCIS crossing ', my_site, '.')

grid::grid.raster(get_img())

# knitr::include_graphics(get_img_path())
```

<br>


```{r photo-197542-02, fig.cap= my_caption, out.width = photo_width, eval=T}

# 
my_photo = pull_photo_by_str(str_to_pull = '_u1_')

my_caption = paste0('Typical habitat upstream of PSCIS crossing ', my_site, '.')

grid::grid.raster(get_img())
# knitr::include_graphics(get_img_path())
```

<br>

```{r photo-197542-02b, fig.cap= my_caption, out.width = photo_width, eval=T}

# 
my_photo = pull_photo_by_str(str_to_pull = '_u2_')

my_caption = paste0('Habitat upstream of PSCIS crossing ', my_site, ' approximatley 3.5km.')

grid::grid.raster(get_img())
# knitr::include_graphics(get_img_path())
```



